
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Pipeline #1: Clustering &#8212; Subtyping PD 1.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script src="../_static/documentation_options.js?v=f2a433a1"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/brainhack_pipeline_1';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Grandpa is moody, will his cognition decline? Predicting cognitive and neural decline in Parkinson’s disease from non-motor symptoms subtypes" href="../index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Subtyping PD 1.0 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item pst-header-nav-item current active">
  <a class="nav-link nav-internal" href="#">
    Pipeline #1: Clustering
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item pst-header-nav-item current active">
  <a class="nav-link nav-internal" href="#">
    Pipeline #1: Clustering
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"></div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">Pipeline...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="Pipeline-#1:-Clustering">
<h1>Pipeline #1: Clustering<a class="headerlink" href="#Pipeline-#1:-Clustering" title="Link to this heading">#</a></h1>
<p>This pipeline does the following: - Visualization of the datasets - Preparation of the inputs for running the SuStaIn algorithm - Launching of the algorithm - Model stability tracking -</p>
<section id="Load-the-library-that-will-be-used">
<h2>Load the library that will be used<a class="headerlink" href="#Load-the-library-that-will-be-used" title="Link to this heading">#</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load libraries</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">pySuStaIn</span>
<span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">import</span> <span class="nn">sklearn.model_selection</span>
<span class="kn">import</span> <span class="nn">wandb</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics.cluster</span> <span class="kn">import</span> <span class="n">adjusted_rand_score</span>


<span class="n">output_folder</span> <span class="o">=</span> <span class="s2">&quot;/Users/song/Documents/dev/repos/10. brainhack 2024/song_project/brainhack_source/results/&quot;</span>
<span class="n">input_folder</span> <span class="o">=</span> <span class="s2">&quot;/Users/song/Documents/dev/repos/10. brainhack 2024/song_project/brainhack_source/data/&quot;</span>
<br/><br/></pre></div>
</div>
</div>
</section>
<section id="Load-the-dataset-(input-'copn'-or-'ppmi')">
<h2>Load the dataset (input ‘copn’ or ‘ppmi’)<a class="headerlink" href="#Load-the-dataset-(input-'copn'-or-'ppmi')" title="Link to this heading">#</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="nb">input</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Selected dataset:&quot;</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>

<span class="n">data_path</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="k">if</span> <span class="n">dataset</span> <span class="o">==</span> <span class="s2">&quot;copn&quot;</span><span class="p">:</span>
    <span class="n">data_path</span> <span class="o">=</span> <span class="n">input_folder</span> <span class="o">+</span> <span class="s2">&quot;dataset_1_copn/data.xlsx&quot;</span>
<span class="k">elif</span> <span class="n">dataset</span> <span class="o">==</span> <span class="s2">&quot;ppmi&quot;</span><span class="p">:</span>
    <span class="n">data_path</span> <span class="o">=</span> <span class="n">input_folder</span> <span class="o">+</span> <span class="s2">&quot;dataset_2_ppmi/data.xlsx&quot;</span>

<span class="c1"># prob_nl</span>
<span class="n">prob_nl</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;1_prob_nl&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;prob_nl:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;shape:&quot;</span><span class="p">,</span> <span class="n">prob_nl</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">prob_nl</span><span class="p">)</span>

<span class="c1"># prob_score</span>
<span class="n">tmp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;2_prob_score&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
<span class="n">original_shape</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">shape</span>
<span class="nb">print</span><span class="p">(</span><span class="n">original_shape</span><span class="p">)</span>

<span class="n">desired_shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">prob_nl</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">prob_score</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">desired_shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;prob_score:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;shape:&quot;</span><span class="p">,</span> <span class="n">prob_score</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">prob_score</span><span class="p">)</span>

<span class="c1"># score_vals</span>
<span class="n">score_vals</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;3_score_vals&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;score_vals&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;shape:&quot;</span><span class="p">,</span> <span class="n">score_vals</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">score_vals</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Selected dataset: copn
prob_nl:
shape: (956, 26)
[[0.752 0.851 0.741 ... 0.885 0.93  0.874]
 [0.752 0.851 0.065 ... 0.029 0.017 0.874]
 [0.062 0.037 0.065 ... 0.029 0.017 0.031]
 ...
 [0.062 0.851 0.065 ... 0.029 0.017 0.031]
 [0.752 0.851 0.065 ... 0.029 0.93  0.874]
 [0.752 0.851 0.741 ... 0.029 0.017 0.031]]
(24856, 4)
prob_score:
shape: (956, 26, 4)
[[[0.06198765 0.06198765 0.06198765 0.06198765]
  [0.0371787  0.0371787  0.0371787  0.0371787 ]
  [0.0648523  0.0648523  0.0648523  0.0648523 ]
  ...
  [0.02875    0.02875    0.02875    0.02875   ]
  [0.0174964  0.0174964  0.0174964  0.0174964 ]
  [0.0314284  0.0314284  0.0314284  0.0314284 ]]

 [[0.06198765 0.06198765 0.06198765 0.06198765]
  [0.0371787  0.0371787  0.0371787  0.0371787 ]
  [0.7405908  0.0648523  0.0648523  0.0648523 ]
  ...
  [0.885      0.02875    0.02875    0.02875   ]
  [0.0174964  0.9300144  0.0174964  0.0174964 ]
  [0.0314284  0.0314284  0.0314284  0.0314284 ]]

 [[0.06198765 0.06198765 0.7520494  0.06198765]
  [0.0371787  0.8512852  0.0371787  0.0371787 ]
  [0.7405908  0.0648523  0.0648523  0.0648523 ]
  ...
  [0.02875    0.885      0.02875    0.02875   ]
  [0.9300144  0.0174964  0.0174964  0.0174964 ]
  [0.0314284  0.8742864  0.0314284  0.0314284 ]]

 ...

 [[0.06198765 0.06198765 0.06198765 0.7520494 ]
  [0.0371787  0.0371787  0.0371787  0.0371787 ]
  [0.0648523  0.0648523  0.7405908  0.0648523 ]
  ...
  [0.02875    0.885      0.02875    0.02875   ]
  [0.0174964  0.0174964  0.9300144  0.0174964 ]
  [0.0314284  0.8742864  0.0314284  0.0314284 ]]

 [[0.06198765 0.06198765 0.06198765 0.06198765]
  [0.0371787  0.0371787  0.0371787  0.0371787 ]
  [0.0648523  0.0648523  0.7405908  0.0648523 ]
  ...
  [0.885      0.02875    0.02875    0.02875   ]
  [0.0174964  0.0174964  0.0174964  0.0174964 ]
  [0.0314284  0.0314284  0.0314284  0.0314284 ]]

 [[0.06198765 0.06198765 0.06198765 0.06198765]
  [0.0371787  0.0371787  0.0371787  0.0371787 ]
  [0.0648523  0.0648523  0.0648523  0.0648523 ]
  ...
  [0.885      0.02875    0.02875    0.02875   ]
  [0.0174964  0.9300144  0.0174964  0.0174964 ]
  [0.8742864  0.0314284  0.0314284  0.0314284 ]]]
score_vals
shape: (26, 4)
[[1 2 3 4]
 [1 2 3 0]
 [1 2 3 4]
 [1 2 3 4]
 [1 2 3 4]
 [1 2 3 4]
 [1 2 3 4]
 [1 2 3 4]
 [1 2 3 4]
 [1 2 3 4]
 [1 2 3 4]
 [1 2 3 4]
 [1 2 3 4]
 [1 2 3 4]
 [1 2 3 4]
 [1 2 3 4]
 [1 2 3 0]
 [1 2 3 4]
 [1 2 3 4]
 [1 2 3 4]
 [1 2 3 4]
 [1 2 3 4]
 [1 2 3 4]
 [1 2 3 4]
 [1 2 3 4]
 [1 2 3 4]]
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pheno</span><span class="o">.</span><span class="n">columns</span>
<span class="c1"># Let&#39;s start by having a quick look at the `summary statistics` and `distribution` of `Age`:</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pheno</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>

<span class="c1"># simple histogram with seaborn</span>
<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">pheno</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">],</span>
            <span class="c1">#bins=30,          # increase &quot;resolution&quot;</span>
            <span class="c1">#color=&#39;black&#39;,    # change color</span>
            <span class="c1">#kde=False,        # get rid of KDE (y axis=N)</span>
            <span class="c1">#rug=True,         # add &quot;rug&quot;</span>
            <span class="p">)</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">log_age</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">pheno</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">log_age</span><span class="p">,</span>
            <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
            <span class="n">kde</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">rug</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Set-n_s_max:-models-with-1-to-n_s_max-clusters-will-be-fit">
<h2>Set n_s_max: models with 1 to n_s_max clusters will be fit<a class="headerlink" href="#Set-n_s_max:-models-with-1-to-n_s_max-clusters-will-be-fit" title="Link to this heading">#</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_s_max</span> <span class="o">=</span> <span class="nb">input</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Max number of clusters was set to:&quot;</span><span class="p">,</span> <span class="n">n_s_max</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Max number of clusters was set to: 6
</pre></div></div>
</div>
</section>
<section id="Set-n_iterations:-number-of-MCMC-iterations">
<h2>Set n_iterations: number of MCMC iterations<a class="headerlink" href="#Set-n_iterations:-number-of-MCMC-iterations" title="Link to this heading">#</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_iterations</span> <span class="o">=</span> <span class="nb">input</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of MCMC iterations was set to:&quot;</span><span class="p">,</span> <span class="n">n_iterations</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Number of MCMC iterations was set to: 100000
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># output_no = random.randint(100, 999)</span>
<span class="n">output_no</span> <span class="o">=</span> <span class="mi">532</span>

<span class="n">output_path</span> <span class="o">=</span> <span class="n">output_folder</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">output_no</span><span class="p">)</span>
<span class="n">seed</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">biomarkers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Cognition&#39;</span><span class="p">,</span> <span class="s1">&#39;Psychosis&#39;</span><span class="p">,</span> <span class="s1">&#39;Depression&#39;</span><span class="p">,</span> <span class="s1">&#39;Anxiety&#39;</span><span class="p">,</span> <span class="s1">&#39;Apathy&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Impulsivity&#39;</span><span class="p">,</span> <span class="s1">&#39;Insomnia&#39;</span><span class="p">,</span> <span class="s1">&#39;Sleepiness&#39;</span><span class="p">,</span> <span class="s1">&#39;Pain&#39;</span><span class="p">,</span> <span class="s1">&#39;Incontinence&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Constipation&#39;</span><span class="p">,</span> <span class="s1">&#39;Dizziness&#39;</span><span class="p">,</span> <span class="s1">&#39;Fatigue&#39;</span><span class="p">,</span> <span class="s1">&#39;Speech&#39;</span><span class="p">,</span> <span class="s1">&#39;Drooling&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Swallowing&#39;</span><span class="p">,</span> <span class="s1">&#39;Eating&#39;</span><span class="p">,</span> <span class="s1">&#39;Dressing&#39;</span><span class="p">,</span> <span class="s1">&#39;Hygiene&#39;</span><span class="p">,</span> <span class="s1">&#39;Handwriting&#39;</span><span class="p">,</span> <span class="s1">&#39;Hobbies&#39;</span><span class="p">,</span>
            <span class="s1">&#39;Rolling&#39;</span><span class="p">,</span> <span class="s1">&#39;Tremor&#39;</span><span class="p">,</span> <span class="s1">&#39;Arising&#39;</span><span class="p">,</span> <span class="s1">&#39;Walking&#39;</span><span class="p">,</span> <span class="s1">&#39;Freezing&#39;</span><span class="p">]</span>

<span class="c1"># start a new wandb run to track this script</span>
<span class="n">wandb</span><span class="o">.</span><span class="n">init</span><span class="p">(</span>
    <span class="c1"># set the wandb project where this run will be logged</span>
    <span class="n">project</span><span class="o">=</span><span class="s2">&quot;Brainhack pySuStaIn&quot;</span><span class="p">,</span>

    <span class="c1"># track hyperparameters and run metadata</span>
    <span class="n">config</span><span class="o">=</span><span class="p">{</span>
    <span class="s2">&quot;dataset&quot;</span><span class="p">:</span> <span class="n">dataset</span><span class="p">,</span>
    <span class="s2">&quot;output_no&quot;</span><span class="p">:</span> <span class="n">output_no</span><span class="p">,</span>
    <span class="s2">&quot;n_s_max&quot;</span><span class="p">:</span> <span class="n">n_s_max</span><span class="p">,</span>
    <span class="s2">&quot;n_iterations&quot;</span><span class="p">:</span> <span class="n">n_iterations</span><span class="p">,</span>
    <span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="n">seed</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="c1"># create folder for results if it doesn&#39;t exist already</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">output_path</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">output_path</span><span class="p">)</span>

<span class="c1"># The initializer for the scored events model implementation of AbstractSustain</span>
<span class="c1">#         Parameters:</span>
<span class="c1">#           prob_nl                     - probability of negative/normal class for all subjects across all biomarkers</span>
<span class="c1">#                                         dim: number of subjects x number of biomarkers</span>

<span class="c1">#           prob_score                  - probability of each score for all subjects across all biomarkers</span>
<span class="c1">#                                         dim: number of subjects x number of biomarkers x number of scores</span>
<span class="c1">#           score_vals                  - a matrix specifying the scores for each biomarker</span>
<span class="c1">#                                         dim: number of biomarkers x number of scores</span>
<span class="c1">#           biomarker_labels            - the names of the biomarkers as a list of strings</span>
<span class="c1">#           N_startpoints               - number of startpoints to use in maximum likelihood step of SuStaIn, typically 25</span>
<span class="c1">#           N_S_max                     - maximum number of subtypes, should be 1 or more</span>
<span class="c1">#           N_iterations_MCMC           - number of MCMC iterations, typically 1e5 or 1e6 but can be lower for debugging</span>
<span class="c1">#           output_folder               - where to save pickle files, etc.</span>
<span class="c1">#           dataset_name                - for naming pickle files</span>
<span class="c1">#           use_parallel_startpoints    - boolean for whether or not to parallelize the maximum likelihood loop</span>
<span class="c1">#           seed                        - random number seed</span>

<span class="n">sustain_input_zscore</span> <span class="o">=</span> <span class="n">pySuStaIn</span><span class="o">.</span><span class="n">OrdinalSustain</span><span class="p">(</span>
                            <span class="n">prob_nl</span><span class="p">,</span>
                            <span class="n">prob_score</span><span class="p">,</span>
                            <span class="n">score_vals</span><span class="p">,</span>
                            <span class="n">biomarkers</span><span class="p">,</span>
                            <span class="mi">25</span><span class="p">,</span>
                            <span class="nb">int</span><span class="p">(</span><span class="n">n_s_max</span><span class="p">),</span>
                            <span class="nb">int</span><span class="p">(</span><span class="n">n_iterations</span><span class="p">),</span>
                            <span class="n">output_path</span><span class="p">,</span>
                            <span class="n">dataset</span><span class="p">,</span>
                            <span class="kc">True</span><span class="p">,</span>
                            <span class="n">seed</span><span class="p">)</span>
<span class="n">samples_sequence</span><span class="p">,</span>   \
<span class="n">samples_f</span><span class="p">,</span>          \
<span class="n">ml_subtype</span><span class="p">,</span>         \
<span class="n">prob_ml_subtype</span><span class="p">,</span>    \
<span class="n">ml_stage</span><span class="p">,</span>           \
<span class="n">prob_ml_stage</span><span class="p">,</span>      \
<span class="n">prob_subtype_stage</span>  <span class="o">=</span> <span class="n">sustain_input_zscore</span><span class="o">.</span><span class="n">run_sustain_algorithm</span><span class="p">()</span>

<span class="n">wandb</span><span class="o">.</span><span class="n">finish</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
Tracking run with wandb version 0.17.1</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
Run data is saved locally in <code>/Users/song/Documents/dev/repos/10. brainhack 2024/song_project/brainhack_source/wandb/run-20240614_015521-se778kjy</code></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
Syncing run <strong><a href='https://wandb.ai/song-y/Brainhack%20pySuStaIn/runs/se778kjy' target="_blank">cool-breeze-8</a></strong> to <a href='https://wandb.ai/song-y/Brainhack%20pySuStaIn' target="_blank">Weights & Biases</a> (<a href='https://wandb.me/run' target="_blank">docs</a>)<br/></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
View project at <a href='https://wandb.ai/song-y/Brainhack%20pySuStaIn' target="_blank">https://wandb.ai/song-y/Brainhack%20pySuStaIn</a></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
View run at <a href='https://wandb.ai/song-y/Brainhack%20pySuStaIn/runs/se778kjy' target="_blank">https://wandb.ai/song-y/Brainhack%20pySuStaIn/runs/se778kjy</a></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Found pickle file: /Users/song/Documents/dev/repos/10. brainhack 2024/song_project/brainhack_source/results/532/pickle_files/copn_subtype0.pickle. Using pickled variables for 0 subtype.
Found pickle file: /Users/song/Documents/dev/repos/10. brainhack 2024/song_project/brainhack_source/results/532/pickle_files/copn_subtype1.pickle. Using pickled variables for 1 subtype.
Found pickle file: /Users/song/Documents/dev/repos/10. brainhack 2024/song_project/brainhack_source/results/532/pickle_files/copn_subtype2.pickle. Using pickled variables for 2 subtype.
Found pickle file: /Users/song/Documents/dev/repos/10. brainhack 2024/song_project/brainhack_source/results/532/pickle_files/copn_subtype3.pickle. Using pickled variables for 3 subtype.
Found pickle file: /Users/song/Documents/dev/repos/10. brainhack 2024/song_project/brainhack_source/results/532/pickle_files/copn_subtype4.pickle. Using pickled variables for 4 subtype.
Found pickle file: /Users/song/Documents/dev/repos/10. brainhack 2024/song_project/brainhack_source/results/532/pickle_files/copn_subtype5.pickle. Using pickled variables for 5 subtype.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "bba729af2e7549ebbefe91ad9c59ec39", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
View run <strong style="color:#cdcd00">cool-breeze-8</strong> at: <a href='https://wandb.ai/song-y/Brainhack%20pySuStaIn/runs/se778kjy' target="_blank">https://wandb.ai/song-y/Brainhack%20pySuStaIn/runs/se778kjy</a><br/> View project at: <a href='https://wandb.ai/song-y/Brainhack%20pySuStaIn' target="_blank">https://wandb.ai/song-y/Brainhack%20pySuStaIn</a><br/>Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
Find logs at: <code>./wandb/run-20240614_015521-se778kjy/logs</code></div>
</div>
</section>
<section id="Generate-result-file">
<h2>Generate result file<a class="headerlink" href="#Generate-result-file" title="Link to this heading">#</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_subtypes</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">pickle_filename_s</span> <span class="o">=</span> <span class="n">output_folder</span> <span class="o">+</span> <span class="s1">&#39;/pickle_files/&#39;</span> <span class="o">+</span> <span class="s1">&#39;copn_subtype&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n_subtypes</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.pickle&#39;</span>
<span class="n">pk</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">pickle_filename_s</span><span class="p">)</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">data_to_print</span>
<span class="c1"># print(data_to_print.shape)</span>

<span class="k">for</span> <span class="n">variable</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ml_subtype&#39;</span><span class="p">,</span> <span class="c1"># the assigned subtype</span>
                 <span class="s1">&#39;prob_ml_subtype&#39;</span><span class="p">,</span> <span class="c1"># the probability of the assigned subtype</span>
                 <span class="s1">&#39;ml_stage&#39;</span><span class="p">,</span> <span class="c1"># the assigned stage</span>
                 <span class="s1">&#39;prob_ml_stage&#39;</span><span class="p">,]:</span> <span class="c1"># the probability of the assigned stage</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">variable</span><span class="p">)</span>

    <span class="c1"># add SuStaIn output to dataframe</span>
    <span class="n">results</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">variable</span><span class="p">]</span> <span class="o">=</span> <span class="n">pk</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span>

<span class="c1"># write results to excel file</span>
<span class="n">writer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="s2">&quot;/Users/song/Documents/dev/repos/07. pySuStaIn COP-N/results/ordinal/o2/o2.xlsx&quot;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;openpyxl&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">if_sheet_exists</span> <span class="o">=</span> <span class="s1">&#39;replace&#39;</span><span class="p">)</span>
<span class="n">results</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span> <span class="o">=</span> <span class="s2">&quot;4st&quot;</span><span class="p">)</span>
<span class="n">writer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
<section id="Evaluate-the-stability-of-model-using-the-Adjust-Rand-Index-(ARI)">
<h2>Evaluate the stability of model using the Adjust Rand Index (ARI)<a class="headerlink" href="#Evaluate-the-stability-of-model-using-the-Adjust-Rand-Index-(ARI)" title="Link to this heading">#</a></h2>
<p>The ARI is a measure of the similarity between two data clusterings. The Rand Index computes a similarity measure between two clusterings by considering all pairs of samples and counting pairs that are assigned in the same or different clusters in the predicted and true clusterings. The raw RI score is then “adjusted for chance” into the ARI score.</p>
<p>Input # of two models to be compared</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_excel_path</span><span class="p">(</span><span class="n">no_model</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">output_folder</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">no_model</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">no_model</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.xlsx&quot;</span>

<span class="k">def</span> <span class="nf">get_input_model</span><span class="p">(</span><span class="n">no_model</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">get_excel_path</span><span class="p">(</span><span class="n">no_model</span><span class="p">),</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;stability&quot;</span><span class="p">)[</span><span class="s2">&quot;Stab&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">no_model_1</span> <span class="o">=</span> <span class="nb">input</span><span class="p">()</span>
<span class="n">no_model_2</span> <span class="o">=</span> <span class="nb">input</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First model: #&quot;</span><span class="p">,</span> <span class="n">no_model_1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Second model: #&quot;</span><span class="p">,</span> <span class="n">no_model_2</span><span class="p">)</span>

<span class="n">inputs_model_1</span> <span class="o">=</span> <span class="n">get_input_model</span><span class="p">(</span><span class="n">no_model_1</span><span class="p">)</span>
<span class="n">inputs_model_2</span> <span class="o">=</span> <span class="n">get_input_model</span><span class="p">(</span><span class="n">no_model_2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">inputs_model_1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">inputs_model_2</span><span class="p">)</span>

<span class="n">adjusted_rand_score</span><span class="p">(</span><span class="n">inputs_model_1</span><span class="p">,</span> <span class="n">inputs_model_2</span><span class="p">)</span>
<br/><br/><br/><br/><br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
First model: # 532
Second model: # 841
[0, 1, 1, 1, 1, 0, 2, 0, 1, 1, 1, 1, 1, 0, 0, 1, 2, 0, 0, 1, 0, 1, 0, 1, 1, 1, 1, 2, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 0, 2, 2, 1, 0, 0, 2, 1, 0, 2, 1, 0, 0, 0, 1, 2, 2, 1, 2, 2, 0, 0, 2, 2, 2, 2, 2, 1, 1, 1, 1, 2, 2, 0, 0, 2, 2, 1, 2, 1, 1, 1, 1, 0, 1, 1, 2, 2, 2, 0, 1, 2, 2, 1, 0, 1, 1, 1, 2, 2, 2, 2, 2, 2, 0, 2, 2, 0, 0, 2, 2, 0, 1, 1, 2, 1, 0, 0, 1, 2, 0, 2, 1, 2, 2, 2, 1, 1, 0, 2, 2, 1, 2, 1, 2, 1, 2, 0, 2, 2, 1, 1, 2, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 0, 0, 0, 1, 1, 1, 1, 0, 1, 2, 2, 0, 1, 0, 2, 0, 2, 0, 2, 0, 2, 1, 0, 2, 2, 2, 1, 1, 0, 2, 0, 0, 2, 0, 1, 1, 0, 2, 0, 1, 0, 0, 0, 1, 0, 0, 1, 1, 2, 1, 2, 0, 1, 2, 0, 1, 0, 2, 0, 1, 0, 2, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 2, 0, 1, 0, 1, 2, 1, 0, 0, 1, 2, 0, 2, 0, 0, 1, 1, 0, 0, 2, 0, 0, 0, 1, 0, 1, 0, 1, 1, 0, 2, 1, 0, 1, 2, 0, 1, 1, 1, 2, 2, 0, 0, 0, 2, 1, 0, 2, 1, 0, 2, 1, 1, 1, 1, 0, 0, 1, 0, 2, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 1, 1, 1, 0, 2, 2, 2, 1, 0, 0, 0, 1, 2, 0, 1, 0, 2, 1, 2, 1, 0, 0, 0, 1, 0, 0, 2, 1, 2, 2, 2, 2, 2, 0, 2, 0, 2, 0, 2, 0, 1, 0, 1, 2, 1, 2, 0, 0, 0, 1, 0, 2, 0, 0, 2, 1, 0, 1, 1, 1, 0, 0, 2, 1, 0, 0, 0, 0, 2, 0, 1, 0, 0, 2, 1, 2, 0, 1, 0, 2, 1, 0, 1, 1, 0, 0, 0, 0, 0, 2, 0, 1, 0, 1, 2, 2, 2, 2, 0, 2, 0, 1, 1, 0, 1, 2, 1, 0, 0, 2, 1, 2, 1, 0, 2, 1, 2, 1, 0, 0, 2, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 1, 0, 2, 1, 0, 0, 1, 2, 0, 0, 0, 0, 0, 0, 0, 2, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 0, 1, 2, 0, 0, 1, 0, 1, 1, 1, 0, 0, 0, 1, 2, 1, 0, 2, 1, 1, 1, 0, 0, 1, 2, 0, 0, 2, 2, 0, 0, 1, 2, 1, 1, 2, 0, 2, 1, 1, 0, 0, 2, 1, 0, 0, 0, 0, 0, 0, 1, 2, 2, 1, 0, 1, 2, 1, 0, 2, 2, 2, 0, 0, 1, 0, 0, 0, 0, 0, 1, 2, 0, 1, 1, 1, 0, 2, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 2, 0, 0, 0, 1, 0, 0, 2, 0, 0, 2, 0, 1, 0, 0, 1, 0, 0, 2, 0, 1, 1, 0, 0, 1, 2, 1, 0, 1, 0, 1, 0, 1, 1, 2, 1, 0, 2, 0, 1, 0, 0, 1, 2, 0, 0, 0, 2, 2, 1, 2, 1, 0, 0, 2, 1, 0, 0, 0, 0, 0, 1, 0, 1, 1, 0, 1, 2, 1, 1, 0, 1, 0, 0, 0, 2, 2, 1, 1, 0, 1, 0, 2, 2, 0, 1, 1, 0, 2, 2, 1, 0, 0, 0, 0, 1, 2, 1, 1, 2, 0, 1, 1, 0, 0, 2, 1, 0, 2, 1, 0, 1, 1, 2, 2, 1, 0, 1, 0, 2, 0, 2, 0, 2, 2, 1, 0, 0, 2, 1, 0, 0, 1, 0, 2, 2, 1, 2, 0, 1, 2, 1, 1, 1, 0, 1, 0, 0, 0, 2, 1, 1, 0, 2, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 2, 0, 2, 0, 1, 0, 0, 0, 2, 0, 1, 2, 1, 1, 2, 1, 2, 0, 0, 2, 0, 1, 2, 1, 0, 1, 0, 0, 1, 2, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 2, 1, 0, 1, 0, 2, 2, 0, 0, 0, 0, 1, 0, 1, 0, 0, 2, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 2, 2, 0, 2, 0, 2, 0, 2, 0, 2, 1, 0, 0, 0, 0, 0, 1, 2, 1, 2, 1, 1, 1, 0, 0, 2, 1, 1, 1, 0, 0, 2, 0, 1, 1, 2, 2, 2, 2, 0, 0, 2, 2, 2, 1, 0, 2, 2, 1, 1, 0, 0, 0, 1, 1, 2, 1, 1, 1, 0, 2, 0, 0, 1, 1, 1, 1, 0, 0, 1, 0, 1, 2, 0, 0, 2, 0, 0, 0, 0, 1, 0, 0, 0, 2, 1, 1, 1, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 2, 0, 1, 2, 2, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 2, 0, 0, 1, 2, 0, 2, 2, 1, 2, 0, 0, 0, 2, 0, 2, 1, 2, 0, 0]
[0, 2, 1, 1, 1, 0, 1, 0, 1, 0, 2, 1, 1, 0, 1, 0, 2, 1, 2, 0, 0, 1, 0, 1, 1, 2, 1, 1, 2, 0, 2, 0, 1, 1, 0, 1, 2, 1, 1, 0, 1, 2, 0, 2, 1, 0, 1, 1, 2, 2, 1, 0, 0, 0, 2, 2, 0, 2, 1, 2, 0, 1, 2, 2, 2, 2, 0, 1, 2, 2, 2, 1, 2, 0, 2, 1, 2, 1, 2, 1, 1, 1, 0, 0, 2, 1, 2, 2, 0, 2, 0, 0, 1, 2, 0, 2, 2, 2, 1, 1, 2, 0, 2, 1, 0, 2, 1, 0, 0, 1, 2, 2, 0, 2, 2, 2, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 2, 2, 0, 0, 2, 2, 2, 1, 2, 2, 0, 0, 0, 1, 1, 2, 2, 0, 0, 1, 0, 2, 0, 2, 0, 2, 1, 1, 0, 0, 0, 0, 0, 2, 2, 1, 1, 1, 2, 0, 1, 0, 2, 1, 1, 1, 0, 1, 1, 2, 0, 1, 0, 2, 0, 1, 0, 1, 0, 0, 0, 2, 0, 2, 2, 2, 0, 1, 0, 1, 0, 0, 1, 1, 2, 0, 0, 2, 1, 1, 1, 0, 2, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 1, 2, 1, 0, 1, 0, 2, 1, 0, 0, 1, 2, 0, 2, 1, 0, 1, 1, 0, 0, 1, 1, 2, 0, 2, 0, 1, 2, 0, 0, 2, 2, 0, 0, 1, 0, 0, 0, 1, 0, 2, 0, 0, 1, 1, 0, 1, 0, 2, 1, 1, 1, 1, 0, 2, 2, 0, 0, 0, 0, 1, 1, 1, 1, 2, 1, 1, 0, 2, 0, 1, 0, 1, 1, 1, 2, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 2, 2, 1, 1, 0, 1, 0, 1, 0, 1, 2, 0, 0, 0, 1, 0, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 2, 1, 2, 0, 1, 1, 2, 2, 2, 0, 2, 2, 0, 0, 2, 2, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 2, 0, 0, 0, 2, 2, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 2, 0, 1, 0, 2, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 2, 2, 0, 1, 0, 1, 0, 2, 1, 1, 0, 1, 1, 1, 1, 2, 1, 1, 0, 2, 0, 0, 0, 1, 1, 2, 2, 2, 0, 1, 0, 2, 1, 1, 2, 0, 0, 1, 1, 0, 0, 0, 2, 1, 0, 1, 0, 0, 0, 1, 2, 1, 0, 0, 2, 0, 0, 1, 0, 2, 1, 0, 2, 0, 2, 1, 1, 0, 2, 1, 1, 0, 2, 1, 0, 0, 1, 0, 1, 2, 2, 0, 1, 0, 0, 1, 2, 0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, 0, 2, 0, 0, 0, 2, 1, 0, 0, 0, 0, 0, 0, 2, 0, 1, 1, 0, 2, 2, 2, 1, 2, 2, 2, 2, 0, 1, 0, 0, 1, 1, 2, 2, 1, 0, 1, 2, 1, 1, 1, 0, 1, 0, 1, 2, 0, 1, 1, 1, 0, 0, 2, 0, 0, 1, 0, 1, 2, 0, 1, 2, 0, 2, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 2, 1, 1, 0, 2, 1, 1, 2, 2, 0, 1, 1, 0, 2, 0, 1, 1, 0, 0, 0, 2, 0, 2, 0, 0, 1, 2, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 2, 0, 1, 0, 0, 2, 0, 2, 0, 1, 1, 0, 0, 0, 0, 2, 1, 0, 0, 1, 0, 1, 2, 0, 0, 2, 0, 2, 2, 1, 0, 0, 0, 0, 0, 0, 1, 2, 2, 0, 1, 2, 2, 0, 0, 2, 0, 1, 2, 0, 1, 1, 0, 0, 1, 1, 2, 1, 2, 0, 2, 0, 1, 1, 2, 2, 0, 2, 1, 2, 0, 2, 0, 0, 2, 1, 1, 2, 1, 0, 2, 0, 1, 2, 1, 1, 0, 0, 1, 1, 1, 1, 1, 2, 0, 1, 2, 2, 1, 1, 0, 0, 1, 0, 0, 1, 0, 0, 2, 0, 0, 2, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 1, 2, 0, 0, 0, 0, 1, 2, 0, 0, 2, 1, 0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 1, 2, 0, 0, 0, 2, 0, 0, 0, 1, 0, 0, 0, 2, 1, 1, 1, 1, 0, 0, 0, 1, 1, 2, 2, 0, 2, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 0, 0, 0, 0, 0, 2, 0, 1, 2, 0, 0, 2, 0, 1, 0, 1, 1, 2, 2, 0, 2, 2, 1, 2, 0, 2, 2, 0, 2, 1, 2, 0, 1, 1, 0, 0, 1, 0, 1, 0, 2, 2, 2, 1, 1, 0, 2, 0, 1, 2, 0, 2, 2, 1, 0, 0, 0, 0, 1, 2, 1, 0, 0, 1, 1, 2, 1, 1, 0, 0, 2, 0, 1, 0, 2, 2, 1, 2, 2, 0, 1, 1, 1, 2, 0, 0, 1, 1, 1, 0, 2, 2, 0, 1, 2, 2, 0, 2, 2, 2, 2, 0, 2, 1, 1, 1, 0, 0, 2, 2, 0, 1, 0, 2, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 2, 0, 0, 2, 1, 0, 0, 0, 0, 1]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.1443848207063997
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[60]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Data</span>
<span class="n">categories</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Subtype 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Subtype 2&#39;</span><span class="p">,</span> <span class="s1">&#39;Subtype 3&#39;</span><span class="p">]</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.165445026</span><span class="p">,</span> <span class="mf">0.165618449</span><span class="p">,</span> <span class="mf">0.166491043</span><span class="p">]</span>

<span class="c1"># Plotting</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">categories</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">])</span>

<span class="c1"># Adding labels and title</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Mean&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Hallucinations&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">0.165</span><span class="p">,</span> <span class="mf">0.167</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_brainhack_pipeline_1_15_0.png" src="../_images/notebooks_brainhack_pipeline_1_15_0.png" />
</div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><strong>Grandpa is moody, will his cognition decline?</strong> Predicting cognitive and neural decline in Parkinson’s disease from non-motor symptoms subtypes</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Load-the-library-that-will-be-used">Load the library that will be used</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Load-the-dataset-(input-'copn'-or-'ppmi')">Load the dataset (input ‘copn’ or ‘ppmi’)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Set-n_s_max:-models-with-1-to-n_s_max-clusters-will-be-fit">Set n_s_max: models with 1 to n_s_max clusters will be fit</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Set-n_iterations:-number-of-MCMC-iterations">Set n_iterations: number of MCMC iterations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Generate-result-file">Generate result file</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Evaluate-the-stability-of-model-using-the-Adjust-Rand-Index-(ARI)">Evaluate the stability of model using the Adjust Rand Index (ARI)</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../_sources/notebooks/brainhack_pipeline_1.ipynb.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, Y Song.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.3.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>